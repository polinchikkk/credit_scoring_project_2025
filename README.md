# Credit-Scoring: GRU + Attention

Предсказываем дефолт по полной кредитной истории. Датасет «Credit Score» с Kaggle (https://www.kaggle.com/datasets/polinchikk/data-for-credit-score). Распаковать в директорию `data/raw/`.
Датасет соревнования устроен таким образом, что кредиты для тренировочной выборки взяты за период в М месяцев, а кредиты для тестовой выборки взяты за последующие K месяцев.
Каждая запись кредитной истории содержит разнообразную информацию о прошлом кредите клиента, например, сумму, отношение клиента к кредиту, дату открытия и закрытия, информацию о просрочках по платежам и др. Все публикуемые данные тщательно анонимизированы. (Их опубликовал Альфа-Банк в рамках соревнования). 
Целевая переменная – бинарная величина, принимающая значения 0 и 1, где 1 соответствует дефолту клиента по кредиту.

## Описание файлов и полей датасета

### 1. `train_target.csv` / `test_target.csv`  
Тренировочная и тестовая выборка кредитов:

| Поле | Описание |
|------|----------|
| `id` | Идентификатор заявки на кредит |
| `flag` | Целевая переменная: `1` — факт ухода клиента в дефолт (есть только в `train_target.csv`) |

### 2. `train_data` / `test_data`  
Данные кредитных историй для обучения и инференса:

| Поле | Описание |
|------|----------|
| `id` | Идентификатор заявки |
| `rn` | Порядковый номер кредитного продукта в кредитной истории |
| `pre_since_opened` | Дней с даты открытия кредита до даты сбора данных |
| `pre_since_confirmed` | Дней с даты подтверждения информации по кредиту до даты сбора данных |
| `pre_pterm` | Плановое количество дней с даты открытия кредита до даты закрытия |
| `pre_fterm` | Фактическое количество дней с даты открытия кредита до даты закрытия |
| `pre_till_pclose` | Плановое количество дней с даты сбора данных до даты закрытия кредита |
| `pre_till_fclose` | Фактическое количество дней с даты сбора данных до даты закрытия кредита |
| `pre_loans_credit_limit` | Кредитный лимит |
| `pre_loans_next_pay_summ` | Сумма следующего платежа по кредиту |
| `pre_loans_outstanding` | Оставшаяся невыплаченная сумма кредита |
| `pre_loans_total_overdue` | Текущая просроченная задолженность |
| `pre_loans_max_overdue_sum` | Максимальная просроченная задолженность |
| `pre_loans_credit_cost_rate` | Полная стоимость кредита |
| `pre_loans5` | Число просрочек до 5 дней |
| `pre_loans530` | Число просрочек от 5 до 30 дней |
| `pre_loans3060` | Число просрочек от 30 до 60 дней |
| `pre_loans6090` | Число просрочек от 60 до 90 дней |
| `pre_loans90` | Число просрочек более чем на 90 дней |
| `is_zero_loans_5` | Флаг: нет просрочек до 5 дней |
| `is_zero_loans_530` | Флаг: нет просрочек от 5 до 30 дней |
| `is_zero_loans_3060` | Флаг: нет просрочек от 30 до 60 дней |
| `is_zero_loans_6090` | Флаг: нет просрочек от 60 до 90 дней |
| `is_zero_loans90` | Флаг: нет просрочек более чем на 90 дней |
| `pre_util` | Отношение оставшейся невыплаченной суммы кредита к кредитному лимиту |
| `pre_over2limit` | Отношение текущей просроченной задолженности к кредитному лимиту |
| `pre_maxover2limit` | Отношение максимальной просроченной задолженности к кредитному лимиту |
| `is_zero_util` | Флаг: отношение оставшейся невыплаченной суммы кредита к кредитному лимиту равно 0 |
| `is_zero_over2limit` | Флаг: отношение текущей просроченной задолженности к кредитному лимиту равно 0 |
| `is_zero_maxover2limit` | Флаг: отношение максимальной просроченной задолженности к кредитному лимиту равно 0 |
| `enc_paym_{0..n}` | Закодированные статусы ежемесячных платежей за последние n месяцев |
| `enc_loans_account_holder_type` | Тип отношения к кредиту |
| `enc_loans_credit_status` | Статус кредита |
| `enc_loans_account_cur` | Валюта кредита |
| `enc_loans_credit_type` | Тип кредита |
| `pclose_flag` | Флаг: плановое количество дней с даты открытия кредита до даты закрытия не определено |
| `fclose_flag` | Флаг: фактическое количество дней с даты открытия кредита до даты закрытия не определено |

### 3. `description.xlsx`  
Описание полей в `train_target.csv` / `test_target.csv` и `train_data` / `test_data`.

### 4. `sample_submission.csv`  
Пример сабмита:

| Поле | Описание |
|------|----------|
| `id` | Идентификатор заявки на кредит |
| `score` | Предсказание модели |

## Быстрый старт

```bash
# установка
python -m pip install -r requirements.txt

# обучение
python -m credit_scoring.train --data data/dataset.parquet --epochs 5

# инференс
python -m credit_scoring.infer --model artifacts/best_model.pt \
                               --json sample_client.json
